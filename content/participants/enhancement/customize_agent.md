---
date: '2025-10-30T14:00:00+09:00'
draft: false
title: 'エージェントのカスタマイズ方法'
category: participants_guide
---

このページでは、**どのメソッドを変えれば動作が変わるか**を最短で把握できます。
実装は **`src/agent/`（役職クラス）** と **`src/agent/agent.py`（基底クラス）** を中心に行います。
共通機能を追加したい場合は **`src/utils/` に新ファイル**を置き、**基底クラス／各役職から呼び出す**のが基本です。

---

## 返り値のルール

* **会話系**：`talk()` / `whisper()` は **テキスト** を返します（発言本文のみ）。
  終了したい日は **`"Over"`** を返すとスキップ扱いです。
* **行動系**：`vote()` / `divine()` / `guard()` / `attack()` は **対象名**（例：`"Agent[03]"`）を返します。
  生存者のみを返すこと（`self.get_alive_agents()` が便利）。
* **初期化系**：`initialize()` / `daily_initialize()` / `daily_finish()` / `finish()` は **サーバに文字列を返さない**（内部処理のみ）。
* **タイムアウト**：各アクションは `setting.timeout.action` に従って自動で監視されます。長考しない実装にしましょう。

---

## エージェントのカスタマイズ方法

### 全役職共通 (src/agent/agent.py)

すべての役職に共通する動作を定義するファイルです。

#### リクエストに対応するメソッド

ゲームサーバから送信されるリクエストに対応するメソッドは下記の通りです。

| メソッド名         | 変更推奨度 | 処理                                         |
| ------------------ | ---------- | -------------------------------------------- |
| `name`             | **非推奨** | 名前リクエストに対する応答を返す             |
| `initialize`       | **中**     | ゲーム開始リクエストに対する初期化処理を行う |
| `daily_initialize` | **中**     | 昼開始リクエストに対する処理を行う           |
| `talk`             | **高**     | トークリクエストに対する応答を返す           |
| `daily_finish`     | **中**     | 昼終了リクエストに対する処理を行う           |
| `divine`           | **高**     | 占いリクエストに対する応答を返す             |
| `vote`             | **高**     | 投票リクエストに対する応答を返す             |
| `finish`           | **中**     | ゲーム終了リクエストに対する処理を行う       |

### 人狼 (src/agent/werewolf.py)

人狼の動作を定義するファイルです。\
すべての役職に共通する動作とは別に以下のメソッドがあります。

| メソッド名 | 変更推奨度 | 処理                             |
| ---------- | ---------- | -------------------------------- |
| `whisper`  | **高**     | 囁きリクエストに対する応答を返す |
| `attack`   | **高**     | 襲撃リクエストに対する応答を返す |

### 狂人 (src/agent/possessed.py)

狂人の動作を定義するファイルです。

### 占い師 (src/agent/seer.py)

人狼の動作を定義するファイルです。\
すべての役職に共通する動作とは別に以下のメソッドがあります。

| メソッド名 | 変更推奨度 | 処理                             |
| ---------- | ---------- | -------------------------------- |
| `divine`   | **高**     | 占いリクエストに対する応答を返す |

#### 占い結果の取得方法

占いフェーズ以降の昼開始リクエスト内の`info.divine_result`から取得できます。\
詳細は[judge.py](https://github.com/aiwolfdial/aiwolf-nlp-common/blob/main/src/aiwolf_nlp_common/packet/judge.py)を参照してください。

### 騎士 (src/agent/bodyguard.py)

騎士の動作を定義するファイルです。\
すべての役職に共通する動作とは別に以下のメソッドがあります。

| メソッド名 | 変更推奨度 | 処理                             |
| ---------- | ---------- | -------------------------------- |
| `guard`    | **高**     | 護衛リクエストに対する応答を返す |

### 村人 (src/agent/villager.py)

村人の動作を定義するファイルです。

### 霊媒師 (src/agent/medium.py)

霊媒師の動作を定義するファイルです。

#### 霊媒結果の取得方法

追放フェーズ以降の昼開始リクエスト内の`info.medium_result`から取得できます。\
詳細は[judge.py](https://github.com/aiwolfdial/aiwolf-nlp-common/blob/main/src/aiwolf_nlp_common/packet/judge.py)を参照してください。

---

## プロンプトから始める（手軽）

* **一番ハードルが低いのはプロンプト改善** です（`config.yml` の `prompt.*`）。
* 発話方針・報告様式・優先順位などをテンプレに落とすだけで、**LLMベースの応答品質**は大きく変わります。
* ロジックを盛り込みたい場合は `utils/` に関数を作り、`agent.py` / 各役職から呼び出すのが安全です。

---

以上でエージェントのカスタマイズ方法の解説は完了です。

---

[参加者マニュアルトップへ](../_index.md)\
[改良・拡張トップへ](./_index.md)\
[前へ（config.ymlの説明）](./config_explanation.md)\
[次へ（大会での対戦方法）](../competition/competition.md)
